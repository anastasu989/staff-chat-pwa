<script type="module">
  // üî• Firebase SDK
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getMessaging, getToken, onMessage } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-messaging.js";

  // ‚ö†Ô∏è –¢–í–û–Ø –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase
  const firebaseConfig = {
   apiKey: "AIzaSyDYjTq4Byv_HvpSymIq7myrdnvSCbetxc8",
  authDomain: "anastasia-b2c21.firebaseapp.com",
  projectId: "anastasia-b2c21",
  storageBucket: "anastasia-b2c21.firebasestorage.app",
  messagingSenderId: "219596761766",
  appId: "1:219596761766:web:aecd1431a8741559c3a267",
  };

  // üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
  const app = initializeApp(firebaseConfig);
  const messaging = getMessaging(app);

  // üìå –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è service worker
  const registration = await navigator.serviceWorker.register("/staff-chat-pwa/service-worker.js");

  // üîë –¢–í–û–ô VAPID KEY (–¢–û–¢, –ß–¢–û –¢–´ –°–û–ó–î–ê–õ–ê)
  const vapidKey = "–í–°–¢–ê–í–¨_–°–Æ–î–ê_–¢–í–û–ô_VAPID_KEY";

  // üîî –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
  const permission = await Notification.requestPermission();
  if (permission === "granted") {
    const token = await getToken(messaging, {
      vapidKey,
      serviceWorkerRegistration: registration
    });

    console.log("üî• FCM TOKEN:", token);
    alert("–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã ‚úÖ");
  } else {
    alert("–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∑–∞–ø—Ä–µ—â–µ–Ω—ã ‚ùå");
  }

  // üì© –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–æ–≥–¥–∞ —Å–∞–π—Ç –æ—Ç–∫—Ä—ã—Ç
  onMessage(messaging, (payload) => {
    console.log("–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ:", payload);
    alert(payload.notification.title);
  });
</script>
